---
name: suggest-branch
description: 作業内容を分析して適切なブランチ名を提案
allowed-tools: "Bash"
---

# ブランチ名提案

作業内容を分析し、`feature/` または `fix/` プレフィックス付きのブランチ名を提案する。

## 入力

`$ARGUMENTS` にベースブランチ名が渡される（省略時は `main`）。

## 手順

### 1. ベースブランチの決定

- `$ARGUMENTS` が指定されている場合はそれをベースブランチとする
- 未指定の場合は `main` をベースブランチとする

### 2. 現在の状態を確認

`git status` と `git branch --show-current` を実行し、現在のブランチと作業状態を把握する。

### 3. ベースブランチとの差分を確認

以下を実行して変更内容を把握する。

- `git log <base>..HEAD --oneline` でコミット済みの差分
- `git diff --stat` で未ステージの変更概要
- `git diff --cached --stat` でステージ済みの変更概要

差分がある場合は、必要に応じて `git diff <base>` や `git log <base>..HEAD --format="%s"` で詳細を確認する。

### 4. ブランチ名の生成

#### 差分がある場合

変更内容を分析してブランチ名を生成する。

現在のブランチがベースブランチ以外（既にフィーチャーブランチ上）の場合は、現在のブランチ名が変更内容を適切に表しているかも評価する。

- 適切な場合 → 現在のブランチ名をそのまま推奨
- 不適切な場合（変更のスコープが広がった等）→ より適切な名前を提案し、リネームを推奨

#### 差分がない場合

ユーザーに「どのような作業を行う予定ですか？」と質問し、回答からブランチ名を生成する。

注意: 非対話モード（`codex exec`）では対話的な質問ができないため、差分がない場合は「差分が見つかりません。作業内容を引数で指定してください。」と出力して終了する。

#### 命名ルール

- プレフィックス
  - 新機能、機能追加、改善 → `feature/`
  - バグ修正 → `fix/`
- 本体部分
  - kebab-case（ハイフン区切り）
  - 英語
  - 簡潔（2-4語程度）
  - 内容が直感的に分かる名前
- 既存ブランチの慣例を参考にする
  - `git branch -r` で既存のリモートブランチ名を確認

### 5. 結果の提示

提案するブランチ名を表示する。

現在のブランチ名が適切でない場合は、リネームコマンドも併せて表示する。

```text
git branch -m <new-branch-name>
```

ブランチの作成やリネームの実行は行わない。
